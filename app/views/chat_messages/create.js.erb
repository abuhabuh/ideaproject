<% broadcast PUSHER_CHANNEL_PREFIX_IDEA+@chat_message.idea_id.to_s, PUSHER_CHAT_MSG_EVENT do %>
  $(document).ready(function(){

    $("#<%=ID_TAG_IDEA_CHAT+@chat_message.idea_id.to_s%>").append
      ("<%= escape_javascript(
        render :partial => "shared_modules/chat_msg_item", :locals => {:msg => @chat_message}
      ) %>");
    
    $("div#<%=ID_TAG_IDEA_CHAT+@chat_message.idea_id.to_s%>").prop({
      scrollTop: $("div#<%=ID_TAG_IDEA_CHAT+@chat_message.idea_id.to_s%>").prop("scrollHeight")
    });

  });
<% end %>

$(document).ready(function(){
  $("#chat_message_text").val("");
});
