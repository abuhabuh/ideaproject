<header>

<% unless user_signed_in? %>
  <div class='main-header-full-width-container-no-menu'>
<% else %>
  <% if current_user.auth_page_layout == PAGE_LAYOUT_AUTH_HOME_STREAM %>
  <div class='main-header-full-width-container-no-menu'>
  <% else %>
  <div class='main-header-full-width-container-menu'>
  <% end %>
<% end %>
    <div class='header-center-container'>
      
        <div class="main-header-left-content">
          <%= link_to content_tag(:b, 'JustAnIdea'), root_url%>
          <br />
          <% if user_signed_in? %>
            <span class="minor-link"><%=link_to "Feedback? Chat us up!", feedback_path, {:target => "_blank"} %></span>
          <% end %>
        </div>

        <% if user_signed_in? %>

          <div class='main-header-center-content'>
            <%= form_tag add_idea_path, :method => 'post' do %>
              <% if @initial_idea.nil? || @initial_idea.blank? %>
                <%= text_field_tag :idea, INPUT_BOX_ADD_IDEA, :size => "40" %>
              <% else %>
                <%= text_field_tag :idea, @initial_idea %>
              <% end %>      
              <%= submit_tag "Add Idea" %>
            <% end %>
            
            <div class='idea-stream-content-view-selector'>
              View: 
              <% case session[:stream_view] %>
                <% when STREAM_VIEW_PUBLIC %>
                  Public | 
                  <%= link_to 'Friends', 
                              authenticated_home_path(:stream_view => STREAM_VIEW_FRIENDS), 
                                                      {:method => 'get', 
                                                       :title => "See friends' ideas"}%><br/>

                <% when STREAM_VIEW_FRIENDS %>  
                  <%= link_to 'Public', authenticated_home_path(:stream_view => STREAM_VIEW_PUBLIC), 
                                                                {:method => 'get', 
                                                                 :title => "See public ideas"}%> | 
                  Friends<br/>

                <% when STREAM_VIEW_SEARCH %>
                  <%= link_to 'Public',
                             authenticated_home_path(:stream_view => STREAM_VIEW_PUBLIC),
                             {:method => 'get',
                              :title => "See public ideas"}%> | 
                  <%= link_to 'Friends',
                             authenticated_home_path(:stream_view => STREAM_VIEW_FRIENDS),
                             {:method => 'get',
                             :title => "See friends' ideas"}%> | 
                  Search <br />

              <% end %>
            </div>
            
            <% unless current_user.auth_page_layout == PAGE_LAYOUT_AUTH_HOME_STREAM %>
              <div class='nav-main-link round'><%= link_to 'Community', users_path %></div>
              
              <div class='nav-main-link round'><%= link_to 'My Ideas', users_profile_path%></div>

              <div class='nav-main-link-unimplemented round'>My Events</div>
            <% end %>

          </div>
          
        <% end %>

        <div class='main-header-right-content'>
          <div class='minor-text'>
            <b>
            <% if user_signed_in? %>
              Hello <%= link_to current_user.first_name.empty? ? current_user.user_name : current_user.first_name, users_profile_path %><br/>
              <%= link_to 'Sign Out', destroy_user_session_path, :method => :delete%>
              <br/>
              Layout:<br/>
              <%= link_to 'Block', user_set_view_layout_path(:layout => PAGE_LAYOUT_AUTH_HOME_BLOCK), :method => 'post' %> | 
              <%= link_to 'Stream', user_set_view_layout_path(:layout => PAGE_LAYOUT_AUTH_HOME_STREAM), :method => 'post' %> | Magazine
	          <% else %>
              <%= link_to 'Sign In', new_user_session_path, options = {:rel => 'facebox'} %><br/>
	          <% end %>
            </b>
          </div>
        </div>

      
    </div>
  </div>

  <!-- AJAX picks up DIV ids to insert proper notices -->
  <div id='flash-notice-div'>
    <% if flash[:notice] %>
      <%= render :partial => "layouts/flash_notice" %>
    <% end %>
  </div>
  <div id='flash-alert-div'>
    <% if flash[:alert] %>
      <%= render :partial => "layouts/flash_alert" %>
    <% end %>
  </div>
  <!-- or flash.each do |key, msg| -->

</header>
